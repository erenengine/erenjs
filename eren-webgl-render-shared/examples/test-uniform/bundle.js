(()=>{"use strict";const r=WebGL2RenderingContext.ARRAY_BUFFER,t=WebGL2RenderingContext.ELEMENT_ARRAY_BUFFER,e=WebGL2RenderingContext.STATIC_DRAW,o=WebGL2RenderingContext.FLOAT;class n{#r;#t;constructor(r,t,e){this.#r=r,this.#t=this.#r.createProgram(t,e)}use(){this.#r.useProgram(this.#t)}getUniformLocation(r){return this.#r.getUniformLocation(this.#t,r)}}var i,a=1e-6,s="undefined"!=typeof Float32Array?Float32Array:Array;function l(r,t){var e=new s(2);return e[0]=r,e[1]=t,e}function h(r,t,e){var o=new s(3);return o[0]=r,o[1]=t,o[2]=e,o}function c(){var r=new s(16);return s!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)}),i=new s(2),s!=Float32Array&&(i[0]=0,i[1]=0),function(){var r=new s(3);s!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0)}();const g={r:.1921,g:.302,b:.4745,a:1},u=[{pos:l(-.5,-.5),color:h(1,0,0)},{pos:l(.5,-.5),color:h(0,1,0)},{pos:l(.5,.5),color:h(0,0,1)},{pos:l(-.5,.5),color:h(1,1,1)}],d=[0,1,2,2,3,0];class f{#r;#t;#e;#o;#n;#i;#a;constructor(i){this.#r=i,this.#t=new n(i,"#version 300 es\nprecision mediump float;\n\nuniform mat4 uModel;\nuniform mat4 uView;\nuniform mat4 uProj;\n\nin vec2 aPosition;\nin vec3 aColor;\n\nout vec3 vColor;\n\nvoid main() {\n    gl_Position = uProj * uView * uModel * vec4(aPosition, 0.0, 1.0);\n    vColor = aColor;\n}\n","#version 300 es\nprecision mediump float;\n\nin  vec3 vColor;\nout vec4 outColor;\n\nvoid main() {\n    outColor = vec4(vColor, 1.0);\n}\n"),this.#e=i.createVertexArray(),i.bindVertexArray(this.#e);const a=i.createBuffer();i.bindBuffer(r,a),i.bufferData(r,function(r){const t=new Float32Array(5*r.length);for(let e=0;e<r.length;e++){const o=5*e;t.set(r[e].pos,o+0),t.set(r[e].color,o+2)}return t}(u),e);const s=i.createBuffer();i.bindBuffer(t,s),i.bufferData(t,new Uint16Array(d),e),i.enableVertexAttribArray(0),i.vertexAttribPointer(0,2,o,!1,20,0),i.enableVertexAttribArray(1),i.vertexAttribPointer(1,3,o,!1,20,8);let l=this.#t.getUniformLocation("uModel"),h=this.#t.getUniformLocation("uView"),c=this.#t.getUniformLocation("uProj");if(!l)throw new Error("Failed to get uniform location (uModel)");if(!h)throw new Error("Failed to get uniform location (uView)");if(!c)throw new Error("Failed to get uniform location (uProj)");this.#o=l,this.#n=h,this.#i=c,this.#a=Date.now()}#s(r,t){const e=(performance.now()-this.#a)/1e3,o={model:c(),view:c(),proj:c()};!function(r,t){var e=Math.sin(t),o=Math.cos(t);r[0]=o,r[1]=e,r[2]=0,r[3]=0,r[4]=-e,r[5]=o,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1}(o.model,-90*e*Math.PI/180);const n=h(2,2,2),i=h(0,0,0),s=h(0,0,1);!function(r,t,e,o){var n,i,s,l,h,c,g,u,d,f,m=t[0],A=t[1],w=t[2],v=o[0],b=o[1],P=o[2],p=e[0],M=e[1],L=e[2];Math.abs(m-p)<a&&Math.abs(A-M)<a&&Math.abs(w-L)<a?function(r){r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1}(r):(g=m-p,u=A-M,d=w-L,n=b*(d*=f=1/Math.hypot(g,u,d))-P*(u*=f),i=P*(g*=f)-v*d,s=v*u-b*g,(f=Math.hypot(n,i,s))?(n*=f=1/f,i*=f,s*=f):(n=0,i=0,s=0),l=u*s-d*i,h=d*n-g*s,c=g*i-u*n,(f=Math.hypot(l,h,c))?(l*=f=1/f,h*=f,c*=f):(l=0,h=0,c=0),r[0]=n,r[1]=l,r[2]=g,r[3]=0,r[4]=i,r[5]=h,r[6]=u,r[7]=0,r[8]=s,r[9]=c,r[10]=d,r[11]=0,r[12]=-(n*m+i*A+s*w),r[13]=-(l*m+h*A+c*w),r[14]=-(g*m+u*A+d*w),r[15]=1)}(o.view,n,i,s);const l=r/t;return function(r,t,e,o,n){var i,a=1/Math.tan(t/2);r[0]=a/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,null!=n&&n!==1/0?(i=1/(o-n),r[10]=(n+o)*i,r[14]=2*n*o*i):(r[10]=-1,r[14]=-2*o)}(o.proj,Math.PI/4,l,.1,10),o}recordCommands(r,t){this.#r.clear(g),this.#t.use(),this.#r.bindVertexArray(this.#e);const e=this.#s(r,t);this.#r.uniformMatrix4fv(this.#o,!1,e.model),this.#r.uniformMatrix4fv(this.#n,!1,e.view),this.#r.uniformMatrix4fv(this.#i,!1,e.proj),this.#r.drawIndexed(d.length,1)}}const m=document.getElementById("canvas"),A=new class{#r;constructor(r){this.#r=r}#l(r,t){const e=this.#r.createShader(t);if(!e)throw new Error("Failed to create shader");if(this.#r.shaderSource(e,r),this.#r.compileShader(e),!this.#r.getShaderParameter(e,this.#r.COMPILE_STATUS)){const r=this.#r.getShaderInfoLog(e);throw this.#r.deleteShader(e),new Error("Failed to compile shader: "+r)}return e}createProgram(r,t){const e=this.#l(r,this.#r.VERTEX_SHADER),o=this.#l(t,this.#r.FRAGMENT_SHADER),n=this.#r.createProgram();if(this.#r.attachShader(n,e),this.#r.attachShader(n,o),this.#r.linkProgram(n),!this.#r.getProgramParameter(n,this.#r.LINK_STATUS)){const r=this.#r.getProgramInfoLog(n);throw this.#r.deleteProgram(n),new Error("Failed to link program: "+r)}return n}useProgram(r){this.#r.useProgram(r)}createVertexArray(){return this.#r.createVertexArray()}bindVertexArray(r){this.#r.bindVertexArray(r)}createBuffer(){return this.#r.createBuffer()}bindBuffer(r,t){this.#r.bindBuffer(r,t)}bufferData(r,t,e){this.#r.bufferData(r,t,e)}enableVertexAttribArray(r){this.#r.enableVertexAttribArray(r)}vertexAttribPointer(r,t,e,o,n,i){this.#r.vertexAttribPointer(r,t,e,o,n,i)}uniformMatrix4fv(r,t,e){this.#r.uniformMatrix4fv(r,t,e)}getUniformLocation(r,t){return this.#r.getUniformLocation(r,t)}clear(r){this.#r.clearColor(r.r,r.g,r.b,r.a),this.#r.clear(this.#r.COLOR_BUFFER_BIT)}draw(r,t){this.#r.drawArraysInstanced(this.#r.TRIANGLES,0,r,t)}drawIndexed(r,t){this.#r.drawElementsInstanced(this.#r.TRIANGLE_STRIP,r,this.#r.UNSIGNED_SHORT,0,t)}}(m.getContext("webgl2")),w=new class{#h;constructor(r){this.#h=new f(r)}render(r,t){this.#h.recordCommands(r,t)}}(A);!function r(){w.render(m.width,m.height),requestAnimationFrame(r)}()})();